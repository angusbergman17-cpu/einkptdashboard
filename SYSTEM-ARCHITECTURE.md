# PTV-TRMNL System Architecture
## Complete Data Flow from Setup to TRMNL Device Display

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    USER INTERACTION LAYER                                         â”‚
â”‚                                                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚  â”‚  Setup Wizard    â”‚â”€â”€â”€â”€â–¶â”‚  Admin Panel     â”‚â”€â”€â”€â”€â–¶â”‚  Journey Planner â”‚                        â”‚
â”‚  â”‚  (/setup)        â”‚     â”‚  (/admin)        â”‚     â”‚                  â”‚                        â”‚
â”‚  â”‚                  â”‚     â”‚                  â”‚     â”‚                  â”‚                        â”‚
â”‚  â”‚ â€¢ State Select   â”‚     â”‚ â€¢ Live Data      â”‚     â”‚ â€¢ Addresses      â”‚                        â”‚
â”‚  â”‚ â€¢ API Keys       â”‚     â”‚ â€¢ System Status  â”‚     â”‚ â€¢ Arrival Time   â”‚                        â”‚
â”‚  â”‚ â€¢ Addresses      â”‚     â”‚ â€¢ API Monitor    â”‚     â”‚ â€¢ Coffee Toggle  â”‚                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚            â”‚                       â”‚                         â”‚                                   â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚                                    â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                 PREFERENCES MANAGER                                               â”‚
â”‚                            (preferences-manager.js)                                               â”‚
â”‚                                                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  STORED CONFIGURATION (user-preferences.json)                                              â”‚ â”‚
â”‚  â”‚                                                                                            â”‚ â”‚
â”‚  â”‚  â€¢ location: { city, state, transitAuthority, lat, lon, timezone }                        â”‚ â”‚
â”‚  â”‚  â€¢ addresses: { home, cafe, work }                                                        â”‚ â”‚
â”‚  â”‚  â€¢ api: { key, token, baseUrl }                                                           â”‚ â”‚
â”‚  â”‚  â€¢ journey: { arrivalTime, coffeeEnabled, transitRoute }                                 â”‚ â”‚
â”‚  â”‚  â€¢ manualWalkingTimes: { homeToStation, stationToCafe, ... }                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                â”‚                â”‚
                    â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GEOCODING SERVICE   â”‚  â”‚   ROUTE PLANNER      â”‚  â”‚   WEATHER SERVICE    â”‚
â”‚  (geocoding-         â”‚  â”‚   (route-planner.js) â”‚  â”‚   (weather-bom.js)   â”‚
â”‚   service.js)        â”‚  â”‚                      â”‚  â”‚                      â”‚
â”‚                      â”‚  â”‚  Uses preferences    â”‚  â”‚  Uses preferences    â”‚
â”‚  6-Tier Fallback:    â”‚  â”‚  for state-agnostic  â”‚  â”‚  to select BOM      â”‚
â”‚  1. Google Places â–¶  â”‚  â”‚  geocoding bias      â”‚  â”‚  weather station    â”‚
â”‚  2. Mapbox        â–¶  â”‚  â”‚                      â”‚  â”‚  based on city      â”‚
â”‚  3. HERE          â–¶  â”‚  â”‚  Calculates:         â”‚  â”‚                      â”‚
â”‚  4. Foursquare    â–¶  â”‚  â”‚  â€¢ Walking times     â”‚  â”‚  Updates every       â”‚
â”‚  5. LocationIQ    â–¶  â”‚  â”‚  â€¢ Station coords    â”‚  â”‚  10 minutes          â”‚
â”‚  6. Nominatim (OSM)  â”‚  â”‚  â€¢ Route distances   â”‚  â”‚                      â”‚
â”‚                      â”‚  â”‚                      â”‚  â”‚                      â”‚
â”‚  24-hour cache       â”‚  â”‚  Decision logging    â”‚  â”‚  Auto station select â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                         â”‚                         â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              EXTERNAL DATA SOURCES LAYER                                          â”‚
â”‚                                                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚  TRANSIT AUTHORITY   â”‚  â”‚  BUREAU OF           â”‚  â”‚  OPENSTREETMAP       â”‚                  â”‚
â”‚  â”‚  API (GTFS-RT)       â”‚  â”‚  METEOROLOGY         â”‚  â”‚  NOMINATIM           â”‚                  â”‚
â”‚  â”‚                      â”‚  â”‚                      â”‚  â”‚                      â”‚                  â”‚
â”‚  â”‚  State-Dependent:    â”‚  â”‚  Official JSON Feeds â”‚  â”‚  Free Geocoding      â”‚                  â”‚
â”‚  â”‚  â€¢ VIC: Transport    â”‚  â”‚                      â”‚  â”‚  (Fallback)          â”‚                  â”‚
â”‚  â”‚    Victoria OpenData â”‚  â”‚  City-Based Stations:â”‚  â”‚                      â”‚                  â”‚
â”‚  â”‚  â€¢ NSW: Transport    â”‚  â”‚  â€¢ Melbourne: 95936  â”‚  â”‚  Always Available    â”‚                  â”‚
â”‚  â”‚    for NSW           â”‚  â”‚  â€¢ Sydney: 94768     â”‚  â”‚                      â”‚                  â”‚
â”‚  â”‚  â€¢ QLD: TransLink    â”‚  â”‚  â€¢ Brisbane: 94576   â”‚  â”‚  ODbL License        â”‚                  â”‚
â”‚  â”‚  â€¢ WA: Transperth    â”‚  â”‚  â€¢ Perth: 94608      â”‚  â”‚                      â”‚                  â”‚
â”‚  â”‚  â€¢ SA: Adelaide Metroâ”‚  â”‚  â€¢ Adelaide: 94672   â”‚  â”‚  User-Agent Required â”‚                  â”‚
â”‚  â”‚  â€¢ TAS: Metro TAS    â”‚  â”‚  â€¢ Hobart: 94970     â”‚  â”‚                      â”‚                  â”‚
â”‚  â”‚  â€¢ ACT: Transport    â”‚  â”‚  â€¢ Canberra: 94926   â”‚  â”‚                      â”‚                  â”‚
â”‚  â”‚    Canberra          â”‚  â”‚  â€¢ Darwin: 94120     â”‚  â”‚                      â”‚                  â”‚
â”‚  â”‚  â€¢ NT: Darwin Bus    â”‚  â”‚                      â”‚  â”‚                      â”‚                  â”‚
â”‚  â”‚                      â”‚  â”‚  CC BY 3.0 AU        â”‚  â”‚                      â”‚                  â”‚
â”‚  â”‚  30-second refresh   â”‚  â”‚                      â”‚  â”‚                      â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚            â”‚                         â”‚                         â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                         â”‚                         â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                 INTELLIGENCE ENGINE                                               â”‚
â”‚                                                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  COFFEE DECISION   â”‚  â”‚  DELAY DETECTION   â”‚  â”‚  JOURNEY OPTIMIZER â”‚  â”‚  MULTI-MODAL     â”‚  â”‚
â”‚  â”‚  ENGINE            â”‚  â”‚                    â”‚  â”‚                    â”‚  â”‚  ROUTER          â”‚  â”‚
â”‚  â”‚                    â”‚  â”‚  Monitors GTFS-RT  â”‚  â”‚  Scoring Algo:     â”‚  â”‚                  â”‚  â”‚
â”‚  â”‚  Calculates:       â”‚  â”‚  every 30 seconds  â”‚  â”‚  â€¢ Arrival (60%)   â”‚  â”‚  Combines 1-2    â”‚  â”‚
â”‚  â”‚  homeâ†’station +    â”‚  â”‚                    â”‚  â”‚  â€¢ Changes (30%)   â”‚  â”‚  transit modes   â”‚  â”‚
â”‚  â”‚  coffee_prep +     â”‚  â”‚  Compares:         â”‚  â”‚  â€¢ Walking (10%)   â”‚  â”‚                  â”‚  â”‚
â”‚  â”‚  cafeâ†’station +    â”‚  â”‚  scheduled vs      â”‚  â”‚                    â”‚  â”‚  Validates:      â”‚  â”‚
â”‚  â”‚  buffer (2 min)    â”‚  â”‚  actual times      â”‚  â”‚  Walking speed:    â”‚  â”‚  â€¢ Connections   â”‚  â”‚
â”‚  â”‚                    â”‚  â”‚                    â”‚  â”‚  4.5 km/h          â”‚  â”‚  â€¢ Buffers       â”‚  â”‚
â”‚  â”‚  < time_to_train?  â”‚  â”‚  Auto-adjusts:     â”‚  â”‚                    â”‚  â”‚  â€¢ Frequencies   â”‚  â”‚
â”‚  â”‚  âœ“ Coffee / âœ— Go   â”‚  â”‚  â€¢ Journey times   â”‚  â”‚  Buffer: 3-5 min   â”‚  â”‚                  â”‚  â”‚
â”‚  â”‚                    â”‚  â”‚  â€¢ Coffee decision â”‚  â”‚                    â”‚  â”‚                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚            â”‚                      â”‚                      â”‚                      â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                      â”‚                      â”‚                      â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             SMART JOURNEY PLANNER                                                 â”‚
â”‚                          (smart-journey-planner.js)                                               â”‚
â”‚                                                                                                   â”‚
â”‚  Combines all intelligence modules to create optimal journey plan:                               â”‚
â”‚                                                                                                   â”‚
â”‚  INPUT:  User preferences, live transit data, weather, geocoded locations                        â”‚
â”‚  OUTPUT: Complete journey with times, routes, coffee decision, delay warnings                    â”‚
â”‚                                                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Journey Plan Structure:                                                                   â”‚ â”‚
â”‚  â”‚  {                                                                                         â”‚ â”‚
â”‚  â”‚    departureTime: "07:45",                                                                 â”‚ â”‚
â”‚  â”‚    arrivalTime: "08:55",                                                                   â”‚ â”‚
â”‚  â”‚    coffeeDecision: { allowed: true/false, reason: "..." },                                â”‚ â”‚
â”‚  â”‚    legs: [                                                                                 â”‚ â”‚
â”‚  â”‚      { type: "walk", from: "Home", to: "Station", duration: 12 },                         â”‚ â”‚
â”‚  â”‚      { type: "train", from: "Origin", to: "Dest", route: "Line", departure: "08:00" },    â”‚ â”‚
â”‚  â”‚      { type: "walk", from: "Station", to: "Work", duration: 5 }                           â”‚ â”‚
â”‚  â”‚    ],                                                                                      â”‚ â”‚
â”‚  â”‚    delays: [...],                                                                          â”‚ â”‚
â”‚  â”‚    weather: {...}                                                                          â”‚ â”‚
â”‚  â”‚  }                                                                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           AUTOMATIC BACKGROUND CALCULATION                                        â”‚
â”‚                                (server.js)                                                        â”‚
â”‚                                                                                                   â”‚
â”‚  setInterval(calculateAndCacheJourney, 10 * 60 * 1000)  // Every 10 minutes                      â”‚
â”‚                                                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  1. Check if preferences are configured                                                    â”‚ â”‚
â”‚  â”‚  2. Call smartPlanner.planJourney() with all user data                                     â”‚ â”‚
â”‚  â”‚  3. Store result in cachedJourney global variable                                          â”‚ â”‚
â”‚  â”‚  4. Log decision to global.decisionLogger                                                  â”‚ â”‚
â”‚  â”‚  5. Make available to all output endpoints                                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                                   â”‚
â”‚  Ensures transit data always current without manual intervention                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                â”‚                â”‚
                    â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API ENDPOINTS       â”‚  â”‚  ADMIN DASHBOARD     â”‚  â”‚  JOURNEY VISUALIZER  â”‚
â”‚                      â”‚  â”‚                      â”‚  â”‚                      â”‚
â”‚  â€¢ /api/screen       â”‚  â”‚  â€¢ Live Data Widgets â”‚  â”‚  â€¢ Real-Time Status  â”‚
â”‚  â€¢ /api/status       â”‚  â”‚  â€¢ API Status Grid   â”‚  â”‚  â€¢ Leg-by-Leg View   â”‚
â”‚  â€¢ /api/journey-     â”‚  â”‚  â€¢ Config Banner     â”‚  â”‚  â€¢ Delay Indicators  â”‚
â”‚    status            â”‚  â”‚  â€¢ Journey Summary   â”‚  â”‚  â€¢ Transit Icons     â”‚
â”‚  â€¢ /api/dashboard    â”‚  â”‚  â€¢ System Status     â”‚  â”‚                      â”‚
â”‚  â€¢ /preview          â”‚  â”‚                      â”‚  â”‚  Updates every 30s   â”‚
â”‚                      â”‚  â”‚  Reflects all setup  â”‚  â”‚                      â”‚
â”‚  JSON/HTML Output    â”‚  â”‚  wizard data live    â”‚  â”‚                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                         â”‚                         â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                   TRMNL DEVICE                                                    â”‚
â”‚                              (E-Ink Display Hardware)                                             â”‚
â”‚                                                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                                                            â”‚ â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚   â”‚  TRMNL Firmware                                                                   â”‚   â”‚ â”‚
â”‚  â”‚   â”‚                                                                                    â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  1. Calls configured endpoint: https://your-server.com/api/screen                 â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  2. Receives JSON markup (TRMNL-specific format)                                  â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  3. Renders to e-ink display with automatic refresh                               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  4. Refresh interval: User configured (e.g., every 5-30 minutes)                  â”‚   â”‚ â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                                                            â”‚ â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚   â”‚  E-Ink Display Output                                                             â”‚   â”‚ â”‚
â”‚  â”‚   â”‚                                                                                    â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â•‘  MELBOURNE TRANSIT    â˜• COFFEE: GO FOR IT!    ğŸŒ¤ï¸ 18Â°C        â•‘               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â•‘                                                                â•‘               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â•‘  ğŸš† CRANBOURNE LINE                                            â•‘               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â•‘  Next: 8:12  â€¢  Then: 8:27  â€¢  8:42                            â•‘               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â•‘                                                                â•‘               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â•‘  ğŸšŠ ROUTE 96 TRAM                                              â•‘               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â•‘  Next: 8:15  â€¢  Then: 8:25  â€¢  8:35                            â•‘               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â•‘                                                                â•‘               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â•‘  YOUR JOURNEY                                                  â•‘               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â•‘  ğŸš¶ Home â†’ Station (12 min)                                    â•‘               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â•‘  â˜• Coffee Stop (3 min)                                        â•‘               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â•‘  ğŸš† Train: 8:12 â†’ 8:45                                         â•‘               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â•‘  ğŸš¶ Station â†’ Work (5 min)                                     â•‘               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â•‘  âœ“ Arrive: 8:50 (10 min early)                                â•‘               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â•‘                                                                â•‘               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚                                                                                    â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  Low power consumption, weeks of battery life                                     â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  Automatic wake from sleep for scheduled refreshes                                â”‚   â”‚ â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                                                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                                   â”‚
â”‚  Device Connection:                                                                               â”‚
â”‚  â€¢ WiFi-enabled                                                                                   â”‚
â”‚  â€¢ Connects to configured server URL                                                              â”‚
â”‚  â€¢ Fetches /api/screen endpoint                                                                   â”‚
â”‚  â€¢ Parses JSON markup into display layout                                                         â”‚
â”‚  â€¢ Updates e-ink screen (partial refresh for efficiency)                                          â”‚
â”‚  â€¢ Sleeps until next scheduled refresh                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              DECISION LOGGING & TRANSPARENCY                                      â”‚
â”‚                                  (decision-logger.js)                                             â”‚
â”‚                                                                                                   â”‚
â”‚  All modules log decisions to global.decisionLogger for complete transparency:                    â”‚
â”‚                                                                                                   â”‚
â”‚  â€¢ Geocoding: Which service was used (Google â†’ Mapbox â†’ HERE â†’ etc.)                             â”‚
â”‚  â€¢ Coffee Decision: Time calculations and final decision                                          â”‚
â”‚  â€¢ Delay Detection: Scheduled vs actual times, severity                                           â”‚
â”‚  â€¢ Route Selection: Scoring algorithm results                                                     â”‚
â”‚  â€¢ Cache Usage: Hits vs misses for each service                                                   â”‚
â”‚  â€¢ Journey Calculation: Successful calculations, timestamps                                       â”‚
â”‚                                                                                                   â”‚
â”‚  Accessible via:                                                                                  â”‚
â”‚  â€¢ /api/decisions (GET) - View all decisions                                                      â”‚
â”‚  â€¢ /api/decisions/export (GET) - Download JSON                                                    â”‚
â”‚  â€¢ Admin Panel â†’ System & Support â†’ Decision Log                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                                    DATA FLOW SUMMARY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. USER SETUP (One-Time)
   Setup Wizard â†’ Preferences Manager â†’ Save to user-preferences.json

2. AUTOMATIC CALCULATION (Every 10 Minutes)
   Preferences â†’ Smart Planner â†’ External APIs â†’ Intelligence Engine â†’ Cached Journey

3. LIVE DATA UPDATES (Every 30 Seconds)
   GTFS-RT APIs â†’ Delay Detection â†’ Update Cached Journey â†’ Admin Dashboard

4. TRMNL DEVICE REFRESH (User Configured, e.g., Every 15 Minutes)
   TRMNL â†’ /api/screen â†’ Cached Journey + Live Data â†’ JSON Markup â†’ E-Ink Display

5. ADMIN MONITORING (Real-Time)
   Admin Panel â†’ /api/system-status â†’ Live Widgets â†’ User Sees Current State

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## Key Features

âœ… **State-Agnostic**: Works across all 8 Australian states/territories
âœ… **Automatic Updates**: Journey calculated every 10 minutes in background
âœ… **Real-Time Delays**: GTFS-Realtime monitoring with auto-adjustment
âœ… **Multi-Tier Fallback**: 6 geocoding services ensure addresses always resolve
âœ… **Complete Transparency**: All decisions logged for troubleshooting
âœ… **Dynamic Configuration**: Live data widgets reflect setup wizard choices
âœ… **Low Power Display**: E-ink TRMNL device, weeks of battery life
âœ… **Smart Intelligence**: Coffee decisions, delay detection, route optimization
âœ… **API Monitoring**: Real-time status of all configured services

## Technology Stack

**Backend**: Node.js, Express.js
**APIs**: GTFS-Realtime, BOM Weather, Multi-tier Geocoding
**Storage**: JSON file-based preferences
**Display**: TRMNL E-Ink Device
**Architecture**: Modular, state-agnostic, event-driven

Created by Angus Bergman â€¢ Licensed under CC BY-NC 4.0
