<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TRMNL Setup Flow Simulator</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, sans-serif; background: #1a1a2e; color: #eee; padding: 20px; }
    .container { max-width: 900px; margin: 0 auto; }
    h1 { color: #4ade80; margin-bottom: 5px; }
    .subtitle { color: #888; margin-bottom: 20px; font-size: 14px; }
    .stages { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
    .stage { padding: 8px 16px; background: #2a2a4a; border-radius: 20px; font-size: 12px; cursor: pointer; }
    .stage.active { background: #4ade80; color: #000; }
    .stage.done { background: #166534; }
    .frame { background: #0f0f1a; border: 4px solid #333; border-radius: 16px; padding: 15px; margin-bottom: 15px; }
    .label { font-size: 11px; color: #666; margin-bottom: 8px; }
    .screen { background: #f5f5e8; width: 800px; height: 480px; border: 2px solid #222; position: relative; transform: scale(0.75); transform-origin: top left; margin-bottom: -120px; overflow: hidden; }
    .serial { background: #0a0a0a; border: 1px solid #333; border-radius: 8px; padding: 12px; font-family: monospace; font-size: 11px; max-height: 200px; overflow-y: auto; margin-top: 15px; }
    .serial .ok { color: #4ade80; }
    .serial .info { color: #60a5fa; }
    .serial .warn { color: #fbbf24; }
    .btns { display: flex; gap: 10px; margin-top: 15px; }
    .btn { padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; }
    .btn-p { background: #4ade80; color: #000; }
    .btn-s { background: #333; color: #fff; }
    .cfg { background: #2a2a4a; padding: 15px; border-radius: 8px; margin-top: 15px; font-size: 12px; }
    .cfg h4 { color: #4ade80; margin-bottom: 10px; }
    .cfg-item { margin: 5px 0; color: #aaa; }
    .cfg-item span { color: #fff; }
  </style>
</head>
<body>
  <div class="container">
    <h1>TRMNL Setup Flow Simulator</h1>
    <p class="subtitle">Complete device setup from firmware flash to working dashboard</p>
    <div class="stages" id="stages"></div>
    <div class="frame">
      <div class="label">TRMNL OG - ESP32-C3 - 800x480 E-Ink</div>
      <div class="screen" id="screen"></div>
    </div>
    <div class="cfg">
      <h4>Private Config (Testing)</h4>
      <div class="cfg-item">Home: <span>1 Clara Street, South Yarra VIC</span></div>
      <div class="cfg-item">Work: <span>80 Collins Street, Melbourne VIC</span></div>
      <div class="cfg-item">State: <span>VIC</span></div>
      <div class="cfg-item">API: <span>ce606b90-****</span></div>
    </div>
    <div class="serial" id="serial"></div>
    <div class="btns">
      <button class="btn btn-s" onclick="prev()">Previous</button>
      <button class="btn btn-p" onclick="next()">Next Stage</button>
      <button class="btn btn-s" onclick="reset()">Reset</button>
    </div>
  </div>
  <script>
    const stageNames = ["1. Flash", "2. WiFi", "3. Register", "4. Config", "5. Dashboard"];
    let cur = 0;
    const scr = document.getElementById("screen");
    const ser = document.getElementById("serial");
    const stg = document.getElementById("stages");
    stageNames.forEach((n,i) => { stg.innerHTML += \`<div class="stage" onclick="go(\${i})">\${n}</div>\`; });
    function log(t,c="info") { ser.innerHTML += \`<div class="\${c}">\${t}</div>\`; ser.scrollTop = 99999; }
    function clr() { ser.innerHTML = ""; }
    function upd() { document.querySelectorAll(".stage").forEach((s,i) => { s.className = "stage" + (i<cur?" done":"") + (i===cur?" active":""); }); }
    function go(i) { cur = i; render(); }
    function next() { if(cur<4) { cur++; render(); } }
    function prev() { if(cur>0) { cur--; render(); } }
    function reset() { cur = 0; render(); }
    function render() {
      clr(); upd();
      if(cur===0) { scr.innerHTML = \`<div style="background:#1a1a1a;color:#4ade80;height:100%;text-align:center;padding-top:100px;"><div style="font-size:24px;">FIRMWARE FLASH</div><div style="margin:30px auto;width:80%;height:20px;background:#333;border-radius:10px;"><div style="width:100%;height:100%;background:#4ade80;border-radius:10px;"></div></div><div>v5.31 - Flash Complete - 1.1MB</div></div>\`; log("=== PTV-TRMNL Web Flasher ==="); log("Device: ESP32-C3"); log("Port: /dev/cu.usbmodem14101"); log("Writing bootloader.bin...", "ok"); log("Writing partitions.bin...", "ok"); log("Writing firmware.bin...", "ok"); log("Flash complete! 1,125,072 bytes", "ok"); }
      if(cur===1) { scr.innerHTML = \`<div style="height:100%;padding:40px;text-align:center;"><div style="font-size:20px;font-weight:bold;">WiFi Setup Required</div><div style="margin:30px auto;padding:20px;border:2px solid #000;display:inline-block;"><div>Connect to:</div><div style="font-size:24px;font-weight:bold;margin:10px 0;">PTV-TRMNL-Setup</div><div>Then visit: 192.168.4.1</div></div></div>\`; log("=== Boot Sequence ==="); log("Display init: EP75 800x480", "ok"); log("No saved WiFi credentials", "warn"); log("Starting WiFiManager AP..."); log("SSID: PTV-TRMNL-Setup"); log("WiFi connected: 192.168.1.42", "ok"); }
      if(cur===2) { scr.innerHTML = \`<div style="height:100%;padding:30px;"><div style="font-size:18px;font-weight:bold;text-align:center;margin-bottom:20px;">Device Registration</div><div style="border:2px solid #000;padding:15px;background:#fff;"><div style="margin:8px 0;">WiFi: <span style="color:green;">Connected</span></div><div style="margin:8px 0;">Server: <span style="color:green;">ptvtrmnl.vercel.app</span></div><div style="margin:8px 0;">Registration: <span style="color:green;">Complete</span></div><div style="margin:8px 0;">NTP: <span style="color:green;">Synced</span></div></div><div style="text-align:center;margin-top:20px;">Configure at: <b>ptvtrmnl.vercel.app/admin</b></div></div>\`; log("=== Registration ==="); log("POST /api/register"); log("Device ID: trmnl-og-a1b2c3", "ok"); log("NTP sync: 2026-01-29 10:31 AEDT", "ok"); }
      if(cur===3) { scr.innerHTML = \`<div style="height:100%;padding:30px;"><div style="font-size:18px;font-weight:bold;text-align:center;margin-bottom:15px;">Journey Configured!</div><div style="border:2px solid #000;padding:15px;background:#fff;font-size:13px;"><div><b>Home:</b> 1 Clara St, South Yarra</div><div><b>Work:</b> 80 Collins St, Melbourne</div><div><b>Arrive:</b> 09:00 AM</div><div><b>Mode:</b> Train</div><div><b>Coffee:</b> Enabled</div></div><div style="margin-top:15px;padding:10px;background:#e8f5e8;border:1px solid #4a4;"><b>Stops:</b><br>Home: South Yarra Station (450m)<br>Work: Parliament Station (200m)</div></div>\`; log("=== Config Received ==="); log("Home: 1 Clara Street, South Yarra VIC"); log("Work: 80 Collins Street, Melbourne VIC"); log("Geocoding...", "ok"); log("Home stop: South Yarra Station", "ok"); log("Work stop: Parliament Station", "ok"); }
      if(cur===4) { const t = new Date().toLocaleTimeString("en-AU",{hour:"2-digit",minute:"2-digit",hour12:false}); scr.innerHTML = \`<div style="height:100%;position:relative;font-size:12px;"><div style="position:absolute;top:15px;left:20px;"><div style="font-size:40px;font-weight:bold;">\${t}</div><div style="color:#666;">Wednesday, Jan 29</div></div><div style="position:absolute;top:15px;right:20px;text-align:right;"><div style="font-size:26px;">22deg</div><div style="color:#666;">Melbourne</div></div><div style="position:absolute;top:80px;left:20px;right:20px;background:#000;color:#fff;padding:8px 15px;"><b>LEAVE IN 12 MIN</b><span style="float:right;">Arrive by 09:00</span></div><div style="position:absolute;top:130px;left:20px;width:360px;"><div style="font-weight:bold;border-bottom:2px solid #000;padding-bottom:4px;margin-bottom:8px;">TRAINS - South Yarra</div><div style="display:flex;justify-content:space-between;padding:4px 0;border-bottom:1px solid #ddd;"><span>Flinders St</span><b>3 min</b></div><div style="display:flex;justify-content:space-between;padding:4px 0;border-bottom:1px solid #ddd;"><span>Flinders St</span><span>11 min</span></div><div style="display:flex;justify-content:space-between;padding:4px 0;"><span>Flinders St</span><span>19 min</span></div></div><div style="position:absolute;top:130px;right:20px;width:360px;"><div style="font-weight:bold;border-bottom:2px solid #000;padding-bottom:4px;margin-bottom:8px;">TRAMS - Chapel St</div><div style="display:flex;justify-content:space-between;padding:4px 0;border-bottom:1px solid #ddd;"><span>Route 78 Richmond</span><b>2 min</b></div><div style="display:flex;justify-content:space-between;padding:4px 0;border-bottom:1px solid #ddd;"><span>Route 6 City</span><span>7 min</span></div><div style="display:flex;justify-content:space-between;padding:4px 0;"><span>Route 78 Richmond</span><span>14 min</span></div></div><div style="position:absolute;top:280px;left:20px;right:20px;"><div style="font-weight:bold;border-bottom:2px solid #000;padding-bottom:4px;margin-bottom:8px;">JOURNEY - South Yarra to Parliament</div><div style="display:flex;gap:20px;"><div style="flex:1;background:#f0f0f0;padding:10px;border-radius:4px;"><b>Best Option</b><br>Leave 08:42 - Arrive 08:56<br><span style="color:#666;">14 min - Sandringham Line</span></div><div style="flex:1;background:#f0f0f0;padding:10px;border-radius:4px;"><b>Coffee Time</b><br><span style="color:#22c55e;font-weight:bold;">Yes! 8 min spare</span><br><span style="color:#666;">Norman Cage - 3 min walk</span></div></div></div><div style="position:absolute;bottom:0;left:0;right:0;background:#222;color:#fff;padding:8px 20px;font-size:10px;display:flex;justify-content:space-between;"><span>PTV-TRMNL v5.31</span><span>Live Data - Updated 20s ago</span><span>South Yarra, VIC</span></div></div>\`; log("=== DASHBOARD LIVE ===", "ok"); log("Fetching zones..."); log("Zone: time - changed", "ok"); log("Zone: weather - changed", "ok"); log("Zone: trains - changed", "ok"); log("Zone: trams - changed", "ok"); log("Zone: journey - changed", "ok"); log("Full refresh complete!", "ok"); log("Next refresh in 20s..."); }
    }
    render();
  </script>
</body>
</html>
